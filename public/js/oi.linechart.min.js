/**
	Open Innovations line charts in SVG - https://github.com/open-innovations/oi.linechart.js
  */
!function(t){var e=t.OI||{};function i(t,e){if(this.version="0.5.0",!t)return console.error("No element to attach to"),this;var i,c,d,u,p,f,g,y,b,k,m,x,w,v,L,M,P,A,N,S;e||(e={}),u=new h(t).loading(),this.el=t,N="linechart",d="http://www.w3.org/2000/svg",L="number"==typeof e.duration?e.duration:"0s",i=t.clientWidth,c=t.clientHeight;var C=getComputedStyle(t);c-=parseFloat(C.paddingTop)+parseFloat(C.paddingBottom),i-=parseFloat(C.paddingLeft)+parseFloat(C.paddingRight),g=[],S={},o(M={left:0,top:0,right:0,bottom:0,tick:5,"font-size":16,tooltip:{},key:{show:!1,border:{stroke:"black","stroke-width":1,fill:"none"},text:{"text-anchor":"start","dominant-baseline":"hanging","font-weight":"bold",fill:"black","stroke-width":0,"font-family":"sans-serif"}},axis:{x:{},y:{}}},e);var F=Math.round(1e8*Math.random());function T(t,e){"function"==typeof t&&(e=t,t={}),this.trigger=function(i){var r=t;o(r,i),e.call(r.this||this,r)}}function E(t,e){A&&S.click&&S.click.trigger({i:e})}function H(){var t=r(p,"."+N+"-tooltip");t&&t.parentNode.removeChild(t),S.hidetooltip&&S.hidetooltip.trigger();for(var e=document.getElementsByTagName("circle"),i=0;i<e.length;i++)e[i].style.strokeWidth="";return!0}function O(t,e){return{x:t=M.left+(t-y)/(k-y)*(i-M.left-M.right),y:e=M.top+(1-(e-b)/(m-b))*(c-M.bottom-M.top)}}function B(t){return document.createElementNS(d,t)}function R(t,e,r){var h={line:{show:!0,stroke:"black","stroke-width":1,"stroke-linecap":"round","stroke-dasharray":""},grid:{show:!1,stroke:"black","stroke-width":1,"stroke-linecap":"round","stroke-dasharray":""},title:{},ticks:{show:!0},labels:{}};this.ticks={},this.line={},this.el=B("g"),a(this.el,[N+"-grid",N+"-grid-"+t]),this.title=B("text"),this.title.classList.add(N+"-grid-title"),n(this.title,this.el);var d=M["font-size"]||16;return n(this.el,p),this.setProperties=function(t){return o(h,t),this},this.getProperty=function(t){return h.hasOwnProperty(t)?h[t]:null},this.update=function(){var o,a,u,p,f,g,x,w,v,L,P,A;for(o in h.labels||(h.labels={}),this.title.innerHTML=h.title.label||"",a="x"==t?M.left+(i-M.right-M.left)/2:d/2,u="y"==t?M.top+(c-M.top-M.bottom)/2:c-d/2,s(this.title,{x:a,y:u,transform:"y"==t?"rotate(-90,"+a+","+u+")":""}),this.el.removeAttribute("style"),this.line.el||(this.line.el=B("path"),this.line.el.classList.add("line"),this.line.el.setAttribute("vector-effect","non-scaling-stroke"),n(this.line.el,this.el),this.line.animate=new j(this.line.el)),p=[{x:M.left-.5,y:c-M.bottom-.5},{x:"x"==t?i-M.right:M.left-.5,y:"x"==t?c-M.bottom-.5:M.top-.5}],this.line.animate.set({d:{from:"",to:p}}),s(this.line.el,{style:h.line.show?"display:block":"display:none",stroke:h.line.stroke,"stroke-width":h.line["stroke-width"],"stroke-dasharray":h.line["stroke-dasharray"]}),this.ticks)o&&!h.ticks.show&&(this.ticks[o].line&&this.ticks[o].line.parentNode.removeChild(this.ticks[o].line),this.ticks[o].text&&this.ticks[o].text.parentNode.removeChild(this.ticks[o].text),delete this.ticks[o]);for(o in h.labels)void 0!==o&&(void 0===h.labels[o]&&(h.labels[o]={label:""}),g=h.labels[o].align||("x"==t?"bottom":"left"),x=h.labels[o]["text-anchor"]||("y"==t?"left"==g?"end":"start":"middle"),L="x"==t?"bottom"==g?"hanging":"text-bottom":"middle",f="number"==typeof h.labels[o].ticksize?h.labels[o].ticksize:5,a="x"==t?parseFloat(o):"left"==g?y:k,u="x"==t?"bottom"==g?b:m:parseFloat(o),(e=O(a,u)).x=Math.round(e.x),r.x=Math.round(r.x),r=l(e),"x"==t?(h.grid.show&&a!=y&&(e.y="bottom"==g?M.top:c-M.bottom),r.y+="bottom"==g?f:-f):(h.grid.show&&u!=b&&(e.x="left"==g?i-M.right:M.left),r.x+="left"==g?-f:f),"x"==t&&(a<y||a>k)||"y"==t&&(u<b||u>m)?this.ticks[o]&&(this.ticks[o].line&&this.ticks[o].line.el.setAttribute("style","display:none"),this.ticks[o].text&&this.ticks[o].text.el.setAttribute("style","display:none")):(this.ticks[o]?(this.ticks[o].line&&this.ticks[o].line.el.removeAttribute("style"),this.ticks[o].text.el.removeAttribute("style")):(this.ticks[o]={text:{el:B("text")}},f>0&&(this.ticks[o].line={el:B("line")},this.ticks[o].line.animate=new j(this.ticks[o].line.el),n(this.ticks[o].line.el,this.el)),this.ticks[o].text.animate=new j(this.ticks[o].text.el),this.ticks[o].text.el.setAttribute("text-anchor",h["text-anchor"]||x),n(this.ticks[o].text.el,this.el)),this.ticks[o].line&&(this.ticks[o].line.animate.set({x1:{to:e.x-.5},x2:{to:r.x-.5},y1:{to:e.y-.5},y2:{to:r.y-.5}}),s(this.ticks[o].line.el,{stroke:h.grid.stroke,"stroke-width":h.grid["stroke-width"]})),this.ticks[o].text.el.innerHTML=h.labels[o].label||"",s(this.ticks[o].text.el,{stroke:h.labels[o].stroke||"black","stroke-width":h.labels[o]["stroke-width"]||0,fill:h.labels[o].fill||"black","dominant-baseline":L}),P="right"==h.labels[o].align?1:-1,A="top"==h.labels[o].align?-1:1,w=r.x+("y"==t?P*("number"==typeof h.labels[o].offset?h.labels[o].offset:4):0),v=r.y+("x"==t?A*("number"==typeof h.labels[o].offset?h.labels[o].offset:4):0),this.ticks[o].text.animate.set({x:{to:w},y:{to:v}})));n(this.line.el,this.el)},this}function z(e,i,h){var c,d,u,f,g,x;function w(e){var o=parseInt(e.target.getAttribute("data-i"));i[o]?function(e,i,o,l,s){var h,c,d,u,f;if(A){(c=r(A,"."+N+"-tooltip"))||(a(c=document.createElement("div"),[N+"-tooltip"]),n(c,A)),h=r(e,"title").innerHTML,l.label||(l.label=h),"function"==typeof s.label?h=s.label.call(e,{series:i,i:o,data:l}):"string"==typeof s.label&&(h=s.label),h=h.replace(/\n/g,"<br />"),c.innerHTML=h,d="","function"==typeof s.class?d=s.class.call(e,{series:i,i:o,data:l}):"string"==typeof s.class&&(d=s.class),d&&c.setAttribute("class",d),u=e.getBoundingClientRect(),f=p.getBoundingClientRect(),c.setAttribute("style","position:absolute;left:"+Math.round(u.left+u.width/2-f.left+t.scrollLeft)+"px;top:"+Math.round(u.top+u.height/2-f.top)+"px;transform:translate3d(-50%,-100%,0);display:"+(h?"block":"none")),n(A,p),S.showtooltip&&S.showtooltip.trigger({i:o});var g=document.getElementsByTagName("circle");for(o=0;o<g.length;o++)g[o].style.outline="none"}}(e.target,c,o,i[o],c.tooltip):console.error("Bad tooltip "+o,e)}return i||(i=[]),c={points:{show:!0,color:"black","stroke-linecap":"round",stroke:"black","stroke-width":0,"fill-opacity":1},line:{show:!0,color:"#000000","stroke-width":4,"stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":"",fill:"none"},attr:h.attr||{}},d={},u="",f=[],x="",this.el=B("g"),(g={"clip-path":"url(#clip-"+F+")"})[N+"-series"]=e+1,s(this.el,g),a(this.el,[N+"-series",N+"-series-"+(e+1)]),this.select=function(){return d.el.classList.add("on"),this},this.selectItem=function(t){return t>=0&&f[t].el&&w({target:f[t].el}),this},this.deselect=function(){return d.el.classList.remove("on"),this},this.setData=function(t){return i=t||[],this},this.updateRange=function(){for(var t=0;t<i.length;t++)y=Math.min(y,i[t].x),b=Math.min(b,i[t].y),k=Math.max(k,i[t].x),m=Math.max(m,i[t].y);return this},this.getStyle=function(t,e){return c.hasOwnProperty(t)&&c[t].hasOwnProperty(e)?c[t][e]:null},this.getProperty=function(t){return c.hasOwnProperty(t)?c[t]:null},this.getProperties=function(){return c},this.setProperties=function(t){if(t||(t={}),o(c,t),c.class){var e=c.class.split(/ /);a(this.el,e)}return this},this.update=function(){var t,o,r,a,h,p,g,y,b;if(d.el||(d.el=B("path"),d.el.classList.add("line"),s(d.el,{d:"M0 0 L 100,100",stroke:c.line.color||"black"}),n(d.el,this.el),d.animate=new j(d.el)),s(d.el,{style:c.line.show?"display:block":"display:none",stroke:c.line.color||"black","stroke-width":this.getStyle("line","stroke-width"),"stroke-linecap":this.getStyle("line","stroke-linecap"),"stroke-linejoin":this.getStyle("line","stroke-linejoin"),"stroke-dasharray":this.getStyle("line","stroke-dasharray"),fill:this.getStyle("line","fill"),"vector-effect":"non-scaling-stroke"}),f.length>i.length)for(t=f.length-1;t>=i.length;t--)f[t].el.remove(),f.pop();if(f.length<i.length){for(o=f.length;o<i.length;o++)r=B("circle"),(y={cx:0,cy:0,"data-i":o,tabindex:0})[N+"-series"]=e+1,s(r,y),f[o]={el:r,title:B("title"),old:{}},i[o].label||(i[o].label="Point "+(o+1)),c.tooltip||(c.tooltip={}),a=i[o].label+": "+i[o].y.toFixed(2),"function"==typeof c.tooltip.label?a=c.tooltip.label.call(r,{series:c,i:o,data:i[o]}):"string"==typeof c.tooltip.label&&(a=c.tooltip.label),f[o].title.innerHTML=a,n(f[o].title,r),c.tooltip.label&&r.addEventListener("mouseover",(function(t){w(t);for(var e=document.getElementsByTagName("circle"),i=0;i<e.length;i++)e[i].style.strokeWidth="";this.style.strokeWidth="7px";this.style.stroke=this.getAttribute("fill")})),r.addEventListener("click",(function(t){var e=parseInt(t.target.getAttribute("data-i"));i[e]?E(t.target,e):console.error("Bad click "+e,t)})),n(r,this.el),f[o].c=new j(f[o].el);if(c.line.label){(x=B("text")).innerHTML=c.title;var k=O(i[f.length-1].x,i[f.length-1].y);k["dominant-baseline"]="middle",k.fill=c.line.color||"black",c.line.label.padding&&(k.x+=c.line.label.padding),s(x,k),n(x,this.el)}}h=[];var m={};for(o=0;o<f.length;o++)p=(c["stroke-width"]||1)/2,c.points&&("number"==typeof c.points.size&&(p=Math.max(c.points.size,p)),"function"==typeof c.points.size&&(p=c.points.size.call(r,{series:e,i:o,data:i[o]})),"string"==typeof c.points.color&&(b=c.points.color),"function"==typeof c.points.color&&(b=c.points.color.call(r,{series:e,i:o,data:i[o]}))),s(f[o].el,{r:p,fill:b,"fill-opacity":c.points["fill-opacity"],stroke:c.points.stroke,"stroke-width":c.points["stroke-width"]}),g=O(i[o].x,i[o].y),h.push(g),"number"==typeof f[o].old.x&&"number"==typeof f[o].old.y?m=l(f[o].old):"number"==typeof m.x&&"number"==typeof m.y&&(f[o].old=m),f[o].c.set({cx:{from:f[o].old.x||null,to:g.x},cy:{from:f[o].old.y||null,to:g.y}}),f[o].old=g;return d.animate.set({d:{from:u,to:h}}),u=l(h),this},this.remove=function(){d.el.parentNode&&d.el.parentNode.removeChild(d.el);for(var t=0;t<f.length;t++)f[t].el.parentNode&&f[t].el.parentNode.removeChild(f[t].el)},this.setData(i),this.setProperties(h),n(this.el,p),this}function j(e,i){var o,r,a;return o=window.getComputedStyle(t),r=e.tagName.toLowerCase(),i||(i={}),a={},o["animation-duration"]&&(this.duration=o["animation-duration"]),i.duration&&(this.duration=i.duration),this.duration||(this.duration=L),this.duration=parseFloat(this.duration),this.set=function(t){var i,o,h,c,d,u;for(i in e.querySelectorAll("animate").forEach((function(t){t.parentNode.removeChild(t)})),t)if(i){if(d=t[i].from||"",u=t[i].to,!d&&a[i]&&(d=a[i].value),h=null,c=null,"path"==r){for(h="",c="",o=0;o<d.length;o++)h+=(o>0?"L":"M")+d[o].x.toFixed(2)+","+d[o].y.toFixed(2);for(o=0;o<u.length;o++)c+=(o>0?"L":"M")+u[o].x.toFixed(2)+","+u[o].y.toFixed(2);if(d.length>0&&d.length<u.length)for(o=0;o<u.length-d.length;o++)h+="L"+d[d.length-1].x.toFixed(2)+","+d[d.length-1].y.toFixed(2);if(u.length>0&&u.length<d.length)for(o=0;o<d.length-u.length;o++)c+="L"+u[u.length-1].x.toFixed(2)+","+u[u.length-1].y.toFixed(2);h||(h=null)}else d&&(h=l(d)),c=l(u);this.duration&&null!==h&&(a[i]||(a[i]={}),a[i].el=B("animate"),s(a[i].el,{attributeName:i,dur:this.duration||0,repeatCount:"1"}),n(a[i].el,e)),e.setAttribute(i,c),this.duration&&null!==h&&(s(a[i].el,{from:h,to:c,values:h+";"+c}),a[i].el.beginElement(),a[i].value=u)}return this},this}function I(){y=1e100,b=1e100,k=-1e100,m=-1e100;for(var t=0;t<g.length;t++)g[t].updateRange();"number"==typeof P.x.getProperty("min")&&(y=P.x.getProperty("min")),"number"==typeof P.x.getProperty("max")&&(k=P.x.getProperty("max")),"number"==typeof P.y.getProperty("min")&&(b=P.y.getProperty("min")),"number"==typeof P.y.getProperty("max")&&(m=P.y.getProperty("max"))}return p||(s(p=B("svg"),{xmlns:d,version:"1.1",width:i,height:c,viewBox:"0 0 "+i+" "+c,overflow:"visible",style:"max-width:100%;",preserveAspectRatio:"none"}),n(x=B("defs"),p),n(p,t),t.addEventListener("mouseleave",(function(t){H()})),s(A=B("foreignObject"),{width:1,height:1,overflow:"visible"}),n(A,p),s(w=B("clipPath"),{id:"clip-"+F}),n(w,p),s(f=B("rect"),{x:0,y:0,width:i,height:c}),n(f,w)),(P={x:new R("x",M.left,i-M.right-M.left),y:new R("y",M.bottom,c-M.top-M.bottom)}).x.setProperties(M.axis.x||{}),P.y.setProperties(M.axis.y||{}),this.on=function(t,e,i){return"function"==typeof e&&(i=l(e),e={}),S[t]=new T(e,i),this},this.off=function(t){return delete S[t],this},this.getSVG=function(){return p.querySelectorAll("animate").forEach((function(t){t.parentNode.removeChild(t)})),p.outerHTML},this.setProperties=function(t){return o(M,t||{}),P.x.setProperties(M.axis.x||{}),P.y.setProperties(M.axis.y||{}),this},this.addSeries=function(t,e){return t?(e||(e={}),g.push(new z(g.length,t,e)),I(),this.series=g,this):(u.error("No data in series"),this)},this.clear=function(){for(var t=0;t<g.length;t++)g[t].remove();return g=[],this.series=[],this.draw()},this.draw=function(){var t,e,o,l,h,d,u,f,y,b,k,m,w,A,S;for(H(),I(),P.x.update(),P.y.update(),t="<style>",t+="\t."+N+"-series circle { transition: transform "+L+" linear, r "+L+" linear; }\n",t+="\t."+N+"-series circle:focus { stroke-width: 4; }\n",e=0;e<g.length;e++)g[e].update();if(M.key.show){if(o=M["font-size"]||16,l=M.key.padding||5,h=(M.key.label?1:0)*o+2*l+g.length*o,u=0,f=0,!v){if((v={el:B("g"),g:[],border:B("rect")}).el.classList.add("key"),s(v.border,{x:0,y:M.top,width:i,height:h}),"object"==typeof M.key.border)for(w in M.key.border)v.border.setAttribute(w,M.key.border[w]);n(v.border,v.el),n(v.el,p)}for(d=0,y=0;y<g.length;y++)v.g[y]||(v.g[y]=B("g"),v.g[y].setAttribute(N+"-series",y),A=[N+"-series",N+"-series-"+(y+1)],g[y].getProperty("class")&&A.concat(g[y].getProperty("class").split(/ /)),a(v.g[y],A),n(v.g[y],v.el)),v.g[y].innerHTML='<text><tspan dx="'+2*o+'" dy="0">'+(g[y].getProperty("title")||"Series "+(y+1))+'</tspan></text><path d="M0 0 L 1 0" class="line" class="" stroke-width="3" stroke-linecap="round"></path><circle cx="0" cy="0" r="5" fill="silver"></circle>',s(v.g[y].querySelector("tspan"),g[y].getProperty("attr")),d=Math.max(d,v.g[y].getBoundingClientRect().width);for(M.key.position||(M.key.position="top right"),S=M.key.position.split(/ /),u=f=0,t=0;t<S.length;t++)"left"==S[t]?u=M.left+l:"right"==S[t]?u=i-M.right-d-l:"top"==S[t]?f=M.top+l:"bottom"==S[t]&&(f=c-M.bottom-l-h);for(s(v.border,{x:u,width:d+l,y:f}),f+=l,u+=l,y=0;y<g.length;y++){if(b=r(v.g[y],"text"),k=r(v.g[y],"path"),m=r(v.g[y],"circle"),b.setAttribute("x",u),b.setAttribute("y",f+y*o+.2*o),"object"==typeof M.key.text)for(w in M.key.text)b.setAttribute(w,M.key.text[w]);k.setAttribute("d","M"+u+","+(f+(.5+y)*o)+" l "+1.5*o+" 0"),s(m,{cx:u+.75*o,cy:f+(.5+y)*o,fill:(w=g[y].getProperties()).points.color||"","stroke-width":w.points["stroke-width"]||0,stroke:w.points.stroke||""}),w.line.color&&k.setAttribute("stroke",w.line.color)}}return t+="\t."+N+"-grid."+N+"-grid-x ."+N+"-grid-title,."+N+"-grid."+N+"-grid-y ."+N+"-grid-title { text-anchor: middle; dominant-baseline: central; }\n",t+="\t."+N+"-grid."+N+"-grid-y text { dominant-baseline: "+((M.axis.y.labels?M.axis.y.labels.baseline:"")||"middle")+"; }\n",t+="\t."+N+"-tooltip { background: black; color: white; padding: 0.25em 0.5em; margin-top: -1em; transition: left 0.1s linear, top 0.1s linear; border-radius: 4px; white-space: nowrap; }\n",t+="\t."+N+'-tooltip::after { content: ""; position: absolute; bottom: auto; width: 0; height: 0; border: 0.5em solid transparent; left: 50%; top: 100%; transform: translate3d(-50%,0,0); border-color: transparent; border-top-color: black; }\n',t+="\t</style>\n",x&&(x.innerHTML=t),this},u.remove(),this}function o(t,e){for(var i in e)try{e[i].constructor==Object?t[i]=o(t[i],e[i]):t[i]=e[i]}catch(o){t[i]=e[i]}return t}function r(t,e){return t.querySelector(e)}function n(t,e){return e.appendChild(t)}function l(t){return JSON.parse(JSON.stringify(t))}function s(t,e){for(var i in e)t.setAttribute(i,e[i]);return t}function a(t,e){for(var i=0;i<e.length;i++)t.classList.add(e[i]);return t}function h(t){var e=document.createElement("div");return e.classList.add("spinner"),e.setAttribute("style","position:absolute;left:50%;top:50%;transform:translate3d(-50%,-50%,0);"),n(e,t),this.loading=function(){return e.innerHTML="Loading...",this},this.loaded=function(){return e.innerHTML="",this},this.remove=function(){return e&&e.parentNode.removeChild(e),this},this.error=function(t){return e&&(console.error(t),e.innerHTML='<span class="error">ERROR: '+t+"</span>"),this},this}e.ready||(e.ready=function(t){"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)}),e.linechart=function(t,e){return new i(t,e)},t.OI=e}(window||this);
